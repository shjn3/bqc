var M=Object.defineProperty;var H=(i,t,e)=>t in i?M(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var r=(i,t,e)=>(H(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();const k=3e3,$="https://wizq-singleplay-dev.sunstudio.io",V="12027078",v={port:k,apiHost:$,appid:V},A=async function(i){var t;if(!i.ok){const e=await i.json();throw new Error((t=e==null?void 0:e.error)==null?void 0:t.message)}return i.json()},Y=async i=>{var e;const t=`${v.apiHost}/apps/${v.appid}/players/${i}`;try{const n=await fetch(t);return A(n)}catch{throw new Error((e=errorData==null?void 0:errorData.error)==null?void 0:e.message)}},x=async i=>{var t;try{const e=`${v.apiHost}/apps/${v.appid}/players`,n={headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(i)},s=await fetch(e,n);return A(s)}catch{throw new Error((t=errorData==null?void 0:errorData.error)==null?void 0:t.message)}},O={getPlayerData:Y,postPlayerData:x};class b{constructor(t){r(this,"instanceElement");this.instanceElement=t}addEventListener(t,e){var n;(n=this.instanceElement)==null||n.addEventListener(t,e)}dispatchEvent(t,e={}){const n=new CustomEvent(t,{detail:e});this.instanceElement.dispatchEvent(n)}}function C(i){return Object.prototype.toString.call(i).slice(8,-1)}function f(i){if(C(i)!=="Object")return!1;const t=Object.getPrototypeOf(i);return!!t&&t.constructor===Object&&t===Object.prototype}function P(i){return C(i)==="Symbol"}function I(i,t,e,n){const s={}.propertyIsEnumerable.call(n,t)?"enumerable":"nonenumerable";s==="enumerable"&&(i[t]=e),s==="nonenumerable"&&Object.defineProperty(i,t,{value:e,enumerable:!1,writable:!0,configurable:!0})}function B(i,t,e){if(!f(t))return t;let n={};if(f(i)){const d=Object.getOwnPropertyNames(i),u=Object.getOwnPropertySymbols(i);n=[...d,...u].reduce((l,c)=>{const m=i[c];return(!P(c)&&!Object.getOwnPropertyNames(t).includes(c)||P(c)&&!Object.getOwnPropertySymbols(t).includes(c))&&I(l,c,m,i),l},{})}const s=Object.getOwnPropertyNames(t),o=Object.getOwnPropertySymbols(t);return[...s,...o].reduce((d,u)=>{let l=t[u];const c=f(i)?i[u]:void 0;c!==void 0&&f(l)&&(l=B(c,l,e));const m=e?e(c,l,u):l;return I(d,u,m,t),d},n)}function J(i,...t){return t.reduce((e,n)=>B(e,n),i)}const p={PRE_UPDATE:"PRE_UPDATE",UPDATE_SUCCESS:"UPDATE_SUCCESS",UPDATE_FAIL:"UPDATE_FAIL",UPDATE_FINALLY:"UPDATE_FINALLY"};class K extends b{constructor(){super(document.getElementById("modal-update"));r(this,"closeBtn");r(this,"footerCloseBtn");r(this,"updateBtn");r(this,"input");r(this,"show",(e,n,s)=>{if(!this.instanceElement.classList.contains("active")){const o=this.instanceElement.querySelector(".modal--header--title"),a=this.instanceElement.querySelector("#new-value-input");a.setAttribute("data-control",n),o.innerHTML=e,a.value=s,this.instanceElement.classList.add("active")}});r(this,"hide",()=>{this.instanceElement.classList.contains("active")&&this.instanceElement.classList.remove("active")});this.closeBtn=document.querySelector("#modal-update .modal--header .btn.btn-close"),this.footerCloseBtn=document.querySelector("#modal-update .modal--footer .btn-close"),this.updateBtn=document.querySelector("#modal-update .modal--footer .btn-update"),this.input=document.querySelector("#new-value-input"),this.initEvents()}initEvents(){const e=this.instanceElement;if(!e)return;const n=e.querySelector(".modal--background");n==null||n.addEventListener("click",this.hide),this.closeBtn.addEventListener("click",this.hide),this.footerCloseBtn.addEventListener("click",this.hide),this.updateBtn.addEventListener("click",async()=>{try{if(this.dispatchEvent(p.PRE_UPDATE),S.instance.getPlayerId()){const o=S.instance.playerData,a=this.input.dataset.control.split(".");let d=JSON.parse(JSON.stringify(o)),u={},l=u;for(let E=0;E<a.length-1;E++)l[a[E]]={},l=l[a[E]];l[a[a.length-1]]=Math.max(parseInt(this.input.value),0);const c=J(d,{customFields:u}),m=await O.postPlayerData(c);this.dispatchEvent(p.UPDATE_SUCCESS,{message:"Update Success",newValue:this.input.value,playerData:m.data})}}catch(s){this.dispatchEvent(p.UPDATE_FAIL,{message:s.message})}finally{this.hide(),this.dispatchEvent(p.UPDATE_FINALLY,{})}})}}const h={PRE:"PRE",SUCCESS:"SUCCESS",FAIL:"FAIL",FINALLY:"FINALLY"};class z extends b{constructor(){super(document.getElementById("search-form"));r(this,"input");r(this,"button");r(this,"handleSubmitForm",async e=>{var n;try{e.preventDefault(),this.dispatchEvent(h.PRE);const s=(n=this.input)==null?void 0:n.value;if(!s){this.dispatchEvent(h.FAIL,{error:{message:"PlayerID is empty!"}});return}const o=await O.getPlayerData(s);this.dispatchEvent(h.SUCCESS,{json:o})}catch(s){this.dispatchEvent(h.FAIL,{error:{message:s.message}})}finally{this.dispatchEvent(h.FINALLY)}});this.input=document.querySelector(".search-box--input input"),this.button=document.querySelector(".search-button button"),this.initEvents()}initEvents(){var e;(e=this.instanceElement)==null||e.addEventListener("submit",this.handleSubmitForm)}}const G=""+new URL("check-e4a86f6b.png",import.meta.url).href,Q=""+new URL("close-572223d0.png",import.meta.url).href,g={SUCCESS:"SUCCESS",ERROR:"ERROR"};class W{constructor(){r(this,"notificationElement");this.notificationElement=document.querySelector(".notification")}removeToast(t){t&&(t.countdownTimer&&(clearTimeout(t.countdownTimer),t.countdownTimer=void 0),t.style.animation="slide-out-toast 0.7s ease forwards",setTimeout(()=>{t.remove()},1500))}createToast(t,e){if(!this.notificationElement)return;let n=["toast--container"],s="";switch(e){case"SUCCESS":n.push("success"),s=G;break;case"ERROR":n.push("error"),s=Q;break}let o=`
                <div class ="toast--header">
                    <div class="icon-status"> 
                        <img src="${s}" alt=""/>
                    </div>
                    <div class="title">Action Executed!</div>
                </div>
                <div class="toast--body">
                     <div class="message">
                        <p>${t}</p>
                    </div>
                </div>  
                <div class="toast--footer">
                    <div class="wrap--countdown"><span class="countdown"></span></div>
                </div> `;const a=document.createElement("div");return a.classList.add(...n),a.innerHTML=o,this.notificationElement.insertBefore(a,this.notificationElement.firstChild),a.countdownTimer=setTimeout(()=>{this.removeToast(a)},4e3),a}}class X{constructor(){r(this,"screen");r(this,"showLoadingScreen",()=>{this.screen.classList.remove("loading-hide"),this.screen.classList.contains("loading-show")||this.screen.classList.add("loading-show")});r(this,"hideLoadingScreen",()=>{this.screen.classList.remove("loading-show"),this.screen.classList.contains("loading-hide")||this.screen.classList.add("loading-hide")});this.screen=document.querySelector("#loading-screen")}}const Z=""+new URL("logo-d26a4653.webp",import.meta.url).href,R={EDIT_ACTION:"EDIT_ACTION"};class ee extends b{constructor(){super(document.querySelector(".sub-page"));r(this,"rowSelected");r(this,"onEditButton",e=>{this.rowSelected=e;const n=e.children[0].dataset.control,s=e.children[0].innerHTML,o=e.children[1].innerHTML;this.dispatchEvent(R.EDIT_ACTION,{title:s,key:n,value:o})});this.initCopyEvent()}initCopyEvent(){const e=document.querySelector(".sub-page--profile .id .copy-icon");e==null||e.addEventListener("click",()=>{const n=S.instance.getPlayerId();navigator.clipboard.writeText(n)})}update(e){if(!e||e.playerId==""){this.setLoadingContent();return}this.updateContent(e)}setLoadingContent(){if(!this.instanceElement)return;this.instanceElement.classList="sub-page .prevent-select loading";const e=document.querySelector(".sub-page--profile"),n=e.querySelector(".avatar");n.innerHTML="",e.querySelector(".name").innerHTML="",e.querySelector(".id p").innerHTML="";const s=document.querySelector(".sub-page--table tbody");s.innerHTML="<tr></tr>"}updateContent(e){const{name:n,photo:s,customFields:o,playerId:a}=e||{},{level:d=0,coin:u=0,spin:l=0,bullets:c}=o||{},m=(c==null?void 0:c.RocketBulletItem)||0,E=(c==null?void 0:c.RainbowBulletBallItem)||0,D=(c==null?void 0:c.ElectricBulletBallItem)||0,U=(c==null?void 0:c.BombBulletItem)||0,F=[{value:d,title:"Level",key:"level"},{value:u,title:"Coin",key:"coin"},{value:l,title:"Spin",key:"spin"},{value:m,title:"Rocket",key:"bullets.RocketBulletItem"},{value:E,title:"Rainbow",key:"bullets.RainbowBulletBallItem"},{value:D,title:"Electric",key:"bullets.ElectricBulletBallItem"},{value:U,title:"Bomb",key:"bullets.BombBulletItem"}],N=s,_=document.querySelector(".sub-page");_.classList="sub-page .prevent-select";const L=document.querySelector(".sub-page--profile"),T=L.querySelector(".avatar");T.innerHTML="";const y=new Image;y.src=N,y.setAttribute("crossorigin","anonymous"),y.onerror=()=>{y.src=Z},T.appendChild(y),L.querySelector(".name").innerHTML=n,L.querySelector(".id p").innerHTML=a;const w=document.querySelector(".sub-page--table tbody");w.innerHTML="";for(let q of F){const j=this.createRow(q);w.appendChild(j)}}createRow(e){const{value:n,title:s,key:o}=e,a=document.createElement("tr");a.innerHTML=`<td data-control="${o}">${s}</td>
            <td>${n}</td>
            <td>
                <div class="action-icon">
                    <a class="action--edit">Edit</a>
                </div>
            </td>`;const d=a.querySelector(".action--edit");return d.addEventListener("click",this.onEditButton.bind(d,a)),a}updateNewValue(e){this.rowSelected.children[1].innerHTML=modal.input.value}}class S{constructor(){r(this,"modal");r(this,"searchFrom");r(this,"notification");r(this,"loadingScreen");r(this,"subPage");r(this,"rowSelected");r(this,"playerData");r(this,"_instance");r(this,"getPlayerId",()=>{var t;return((t=this.playerData)==null?void 0:t.playerId)||""});this.createModal(),this.createSearchForm(),this.createNotification(),this.createLoadingScreen(),this.createSubPage()}static get instance(){return this._instance||(this._instance=new S),this._instance}createSubPage(){this.subPage=new ee,this.subPage.addEventListener(R.EDIT_ACTION,t=>{const{title:e,key:n,value:s}=t.detail;this.modal.show(e,n,s)})}createLoadingScreen(){this.loadingScreen=new X}createNotification(){this.notification=new W}createModal(){this.modal=new K,this.modal.addEventListener(p.PRE_UPDATE,()=>{this.loadingScreen.showLoadingScreen()}),this.modal.addEventListener(p.UPDATE_SUCCESS,t=>{const{message:e,newValue:n,playerData:s}=t.detail;this.notification.createToast(e,g.SUCCESS),this.playerData=s,this.subPage.update(s)}),this.modal.addEventListener(p.UPDATE_FAIL,t=>{var n;const e=((n=t.detail)==null?void 0:n.message)||"";this.notification.createToast(e,g.ERROR)}),this.modal.addEventListener(p.UPDATE_FINALLY,()=>{this.loadingScreen.hideLoadingScreen(),this.subPage.rowSelected=null})}createSearchForm(){this.searchFrom=new z,this.searchFrom.addEventListener(h.PRE,()=>{this.loadingScreen.showLoadingScreen()}),this.searchFrom.addEventListener(h.SUCCESS,t=>{const e=t.detail.json,n={name:"",photo:"",customFields:{level:0,coin:0,spin:0,bullets:{}},playerId:""};this.notification.createToast("Successfully",g.SUCCESS),Object.keys(n).forEach(s=>{const o=e.data[s];o&&(n[s]=o)}),this.playerData=JSON.parse(JSON.stringify(n)),this.subPage.update(n)}),this.searchFrom.addEventListener(h.FAIL,t=>{var n;const e=((n=t.detail)==null?void 0:n.error.message)||"";this.notification.createToast(e,g.ERROR)}),this.searchFrom.addEventListener(h.FINALLY,()=>{this.loadingScreen.hideLoadingScreen()})}}window.onload=()=>{S.instance};
